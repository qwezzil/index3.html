<!doctype html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>qwezil</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Manrope:wght@500;700;800&family=Orbitron:wght@600;700&family=Space+Grotesk:wght@500;700&display=swap"
    rel="stylesheet"
  />
  <style>
    :root {
      --bg-0: #020710;
      --bg-1: #051526;
      --bg-2: #071f31;
      --card: rgba(8, 16, 28, 0.58);
      --card-edge: rgba(148, 222, 255, 0.24);
      --line-soft: rgba(162, 222, 248, 0.24);
      --text-main: #e9f6ff;
      --text-muted: #9cb6c8;
      --accent-1: #63d4ff;
      --accent-2: #00b0ff;
      --shadow-deep: rgba(0, 8, 20, 0.62);
    }

    * {
      box-sizing: border-box;
    }

    html,
    body {
      width: 100%;
      min-height: 100%;
      margin: 0;
      padding: 0;
      background: var(--bg-0);
      color: var(--text-main);
      font-family: "Manrope", "Segoe UI", sans-serif;
      overflow-x: hidden;
    }

    body {
  background: #020710
    url("https://tenor.com/view/obito-uchiha-obito-gif-6444021882080792179")
    center center / cover no-repeat fixed;
}


    body.pre-enter {
      overflow: hidden;
    }

    .intro-gate {
      position: fixed;
      inset: 0;
      z-index: 80;
      display: grid;
      place-items: center;
      background:
      radial-gradient(1000px 620px at 50% 42%, rgba(46, 112, 173, 0.24), transparent 70%),
        linear-gradient(160deg, #00050c 0%, #020a15 52%, #00050c 100%);
        
      opacity: 1;
      visibility: visible;
      transition: opacity 0.85s ease, visibility 0.85s ease;
    }

    .intro-gate::before,
    .intro-gate::after {
      content: "";
      position: absolute;
      pointer-events: none;
    }

    .intro-gate::before {
      width: min(56vw, 780px);
      height: min(82vh, 980px);
      border-radius: 46px;
      background:
        linear-gradient(90deg, rgba(148, 212, 255, 0.09), rgba(105, 173, 255, 0.06) 46%, rgba(148, 212, 255, 0.09));
      filter: blur(14px);
      opacity: 0.5;
    }

    .intro-gate::after {
      inset: 0;
      background: repeating-linear-gradient(90deg, rgba(120, 197, 255, 0.036) 0, rgba(120, 197, 255, 0.036) 1px, transparent 1px, transparent 9px);
      mix-blend-mode: screen;
      opacity: 0.22;
    }

    .enter-button {
      position: relative;
      z-index: 2;
      border: 0;
      background: transparent;
      color: #f3f8ff;
      font-family: "Orbitron", "Space Grotesk", sans-serif;
      font-size: clamp(32px, 4vw, 52px);
      font-weight: 600;
      letter-spacing: 0.11em;
      cursor: pointer;
      text-shadow:
        0 0 22px rgba(255, 255, 255, 0.2),
        0 10px 24px rgba(0, 0, 0, 0.6);
      transition: transform 0.22s ease, text-shadow 0.22s ease, opacity 0.22s ease;
    }

    .enter-button:hover {
      transform: translateY(-2px) scale(1.02);
      text-shadow:
        0 0 26px rgba(216, 244, 255, 0.34),
        0 12px 26px rgba(0, 0, 0, 0.62);
    }

    .enter-button:focus-visible {
      outline: none;
      opacity: 0.92;
    }

    .intro-dot {
      position: absolute;
      right: clamp(9%, 18vw, 20%);
      top: 68%;
      width: 14px;
      height: 14px;
      border-radius: 50%;
      background: #fff;
      box-shadow:
        0 0 18px rgba(255, 255, 255, 0.76),
        0 0 44px rgba(166, 227, 255, 0.4);
      z-index: 2;
      animation: dotPulse 2s ease-in-out infinite;
    }

    .intro-gate.is-hidden {
      opacity: 0;
      visibility: hidden;
      pointer-events: none;
    }

    .scene {
      position: relative;
      min-height: 100vh;
      isolation: isolate;
      display: grid;
      place-items: center;
      padding: 34px 20px 44px;
      overflow: hidden;
      transition: opacity 0.85s ease, transform 0.85s ease, filter 0.85s ease;
    }

    body.pre-enter .scene {
      opacity: 0;
      pointer-events: none;
      transform: scale(1.015);
      filter: blur(9px);
    }

    .scene::before,
    .scene::after {
      content: "";
      position: absolute;
      inset: 0;
      pointer-events: none;
      z-index: -4;
    }

    .scene::before {
      background:
        linear-gradient(120deg, rgba(255, 255, 255, 0.04) 0%, transparent 32%, transparent 67%, rgba(255, 255, 255, 0.03) 100%),
        repeating-linear-gradient(90deg, rgba(142, 204, 255, 0.045) 0, rgba(142, 204, 255, 0.045) 1px, transparent 1px, transparent 6px);
      opacity: 0.33;
      mix-blend-mode: screen;
    }

    .scene::after {
      background:
        radial-gradient(70% 70% at 50% 60%, transparent 0%, rgba(0, 0, 0, 0.28) 72%, rgba(0, 0, 0, 0.68) 100%);
    }

    .fluid {
      position: absolute;
      pointer-events: none;
      z-index: -2;
      filter: blur(2px);
    }

    .fluid-main {
      width: min(76vw, 980px);
      height: min(63vw, 760px);
      right: max(1vw, -36px);
      top: 10vh;
      border-radius: 52% 48% 61% 39% / 42% 56% 44% 58%;
      background:
        radial-gradient(42% 44% at 26% 22%, rgba(161, 231, 255, 0.58), transparent 74%),
        radial-gradient(40% 44% at 72% 66%, rgba(40, 133, 188, 0.52), transparent 75%),
        linear-gradient(145deg, rgba(82, 187, 230, 0.46), rgba(17, 71, 118, 0.56));
      box-shadow:
        0 0 120px rgba(94, 193, 255, 0.35),
        inset -24px -32px 56px rgba(0, 0, 0, 0.44);
      animation: blobFloat 15s cubic-bezier(0.48, 0.07, 0.23, 0.95) infinite;
    }

    .fluid-side {
      width: min(56vw, 640px);
      height: min(42vw, 500px);
      left: -18vw;
      top: 6vh;
      border-radius: 41% 59% 49% 51% / 62% 44% 56% 38%;
      background: radial-gradient(60% 60% at 58% 44%, rgba(79, 176, 233, 0.34), rgba(16, 58, 103, 0.16) 70%, transparent 100%);
      filter: blur(24px);
      opacity: 0.45;
      animation: blobDrift 17s ease-in-out infinite;
    }

    .fluid-bottom {
      width: min(60vw, 700px);
      height: min(38vw, 470px);
      left: -12vw;
      bottom: -16vh;
      border-radius: 57% 43% 63% 37% / 44% 62% 38% 56%;
      background: radial-gradient(58% 58% at 70% 40%, rgba(74, 188, 255, 0.33), rgba(16, 62, 120, 0.14) 66%, transparent 100%);
      filter: blur(26px);
      opacity: 0.4;
      animation: blobDrift 20s ease-in-out infinite reverse;
    }

    .ink-mask {
      position: absolute;
      pointer-events: none;
      border-radius: 999px;
      z-index: -1;
      mix-blend-mode: multiply;
      filter: blur(12px);
    }

    .ink-mask-right {
      width: min(44vw, 620px);
      height: min(36vw, 500px);
      right: -4vw;
      top: 11vh;
      background: radial-gradient(66% 70% at 30% 56%, rgba(0, 0, 0, 0.76) 0%, rgba(0, 0, 0, 0.26) 64%, transparent 100%);
      animation: inkPulse 15s ease-in-out infinite;
    }

    .ink-mask-left {
      width: min(44vw, 600px);
      height: min(34vw, 480px);
      left: -10vw;
      top: 34vh;
      background: radial-gradient(74% 74% at 72% 28%, rgba(0, 0, 0, 0.66) 0%, rgba(0, 0, 0, 0.16) 66%, transparent 100%);
      animation: inkPulse 19s ease-in-out infinite reverse;
    }

    .content {
      width: min(540px, 100%);
      display: grid;
      place-items: center;
    }

    .panel {
      width: min(420px, 100%);
      text-align: center;
      padding: 0;
      border-radius: 26px;
      background: transparent;
      border: none;
      backdrop-filter: none;
      box-shadow: none;
      animation: panelIn 0.9s cubic-bezier(0.16, 0.84, 0.22, 1) both;
    }

    .avatar-wrap {
      width: 168px;
      height: 168px;
      margin: 0 auto 14px;
      border-radius: 24px;
      overflow: hidden;
      border: none;
      box-shadow: 0 16px 34px rgba(0, 10, 24, 0.54);
      transform: translateY(24px) scale(0.96);
      opacity: 0;
      animation: rise 0.95s 0.14s cubic-bezier(0.21, 0.86, 0.27, 1) forwards;
    }

    .avatar-wrap img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
      transform: scale(1.03);
      filter: saturate(1.08) contrast(1.04);
    }

    h1 {
      margin: 0;
      font-family: "Space Grotesk", "Manrope", sans-serif;
      font-size: clamp(50px, 8.2vw, 68px);
      line-height: 0.92;
      font-weight: 700;
      letter-spacing: -0.04em;
      color: #ebf7ff;
      text-shadow:
        0 0 18px rgba(132, 219, 255, 0.3),
        0 9px 22px rgba(0, 0, 0, 0.4);
      transform: translateY(18px);
      opacity: 0;
      animation: rise 0.9s 0.24s cubic-bezier(0.21, 0.86, 0.27, 1) forwards;
    }

    .actions {
      width: min(250px, 100%);
      margin: 12px auto 0;
      display: grid;
      gap: 10px;
      transform: translateY(16px);
      opacity: 0;
      animation: rise 0.9s 0.34s cubic-bezier(0.21, 0.86, 0.27, 1) forwards;
    }

    .action {
      position: relative;
      isolation: isolate;
      min-height: 52px;
      border-radius: 14px;
      border: none;
      appearance: none;
      -webkit-appearance: none;
      background:
        linear-gradient(170deg, rgba(118, 199, 255, 0.18), rgba(13, 30, 50, 0.62) 38%, rgba(7, 18, 30, 0.8) 100%);
      color: var(--text-main);
      text-decoration: none;
      font-size: clamp(18px, 3vw, 20px);
      font-weight: 700;
      letter-spacing: -0.02em;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      box-shadow: 0 10px 26px rgba(0, 10, 24, 0.45);
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .action svg {
      width: 16px;
      height: 16px;
      opacity: 0.92;
    }

    .action:hover {
      transform: translateY(-2px);
      box-shadow: 0 12px 30px rgba(0, 10, 24, 0.6);
    }

    .action:active {
      transform: translateY(0);
    }

    .action:focus-visible {
      outline: none;
    }

    .now-playing {
      position: fixed;
      left: 50%;
      bottom: 22px;
      transform: translateX(-50%);
      z-index: 45;
      width: min(980px, calc(100vw - 30px));
      display: grid;
      grid-template-columns: 94px 1fr auto;
      align-items: center;
      gap: 16px;
      padding: 12px 16px;
      border-radius: 22px;
      background: transparent;
      border: none;
      backdrop-filter: none;
      box-shadow: none;
      transition: opacity 0.45s ease, transform 0.45s ease;
    }

    body.pre-enter .now-playing {
      opacity: 0;
      transform: translateX(-50%) translateY(14px);
      pointer-events: none;
    }

    .np-cover {
      width: 76px;
      height: 76px;
      border-radius: 16px;
      object-fit: cover;
      display: block;
      background: rgba(250, 252, 255, 0.68);
      box-shadow: 0 6px 20px rgba(10, 18, 34, 0.35);
    }

    .np-main {
      min-width: 0;
    }

    .np-title {
      margin: 0;
      color: #2a0707;
      font-family: "Orbitron", "Space Grotesk", sans-serif;
      font-size: clamp(20px, 2.2vw, 36px);
      letter-spacing: 0.04em;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      text-shadow: 0 1px 0 rgba(255, 255, 255, 0.18);
    }

    .np-row {
      margin-top: 9px;
      display: grid;
      grid-template-columns: auto 1fr auto;
      align-items: center;
      gap: 14px;
      color: #3e1d23;
      font-family: "Orbitron", "Space Grotesk", sans-serif;
      font-size: clamp(16px, 1.4vw, 28px);
      line-height: 1;
    }

    .np-time {
      min-width: 58px;
    }

    .np-time:last-child {
      text-align: right;
    }

    .np-bar {
      position: relative;
      width: 100%;
      height: 4px;
      border-radius: 999px;
      overflow: hidden;
      background: rgba(66, 28, 38, 0.36);
    }

    .np-fill {
      position: absolute;
      inset: 0 auto 0 0;
      width: 0%;
      background: linear-gradient(90deg, rgba(85, 20, 34, 0.9), rgba(43, 5, 10, 0.9));
      border-radius: inherit;
    }

    .np-controls {
      display: inline-flex;
      align-items: center;
      gap: 10px;
    }

    .np-btn {
      width: 30px;
      height: 30px;
      border: 0;
      border-radius: 8px;
      padding: 0;
      background: transparent;
      color: rgba(71, 24, 36, 0.76);
      font-size: 18px;
      line-height: 1;
      display: grid;
      place-items: center;
      cursor: pointer;
      transition: transform 0.18s ease, color 0.18s ease;
    }

    .np-btn:hover {
      transform: scale(1.08);
      color: rgba(55, 11, 21, 0.95);
    }

    .np-btn.play {
      width: 42px;
      height: 42px;
      border-radius: 12px;
      background: rgba(67, 7, 12, 0.92);
      color: #f5eef2;
      font-size: 20px;
      box-shadow: 0 8px 18px rgba(33, 3, 8, 0.45);
    }

    #spotifyApiHost {
      position: fixed;
      left: -9999px;
      bottom: -9999px;
      width: 1px;
      height: 1px;
      opacity: 0;
      pointer-events: none;
    }

    @media (max-width: 900px) {
      .fluid-main {
        width: min(110vw, 760px);
        height: min(82vw, 560px);
        right: -22vw;
        top: 17vh;
      }

      .fluid-side {
        left: -30vw;
      }

      .fluid-bottom {
        left: -24vw;
      }
    }

    @media (max-width: 600px) {
      .scene {
        padding: 22px 14px 32px;
      }

      .enter-button {
        font-size: clamp(28px, 11vw, 42px);
      }

      .intro-dot {
        right: 12%;
        top: 70%;
        width: 10px;
        height: 10px;
      }

      .panel {
        width: min(360px, 100%);
        border-radius: 22px;
        padding: 20px 14px 14px;
      }

      .avatar-wrap {
        width: 136px;
        height: 136px;
        border-radius: 18px;
      }

      h1 {
        font-size: clamp(42px, 14vw, 58px);
      }

      .actions {
        width: min(290px, 100%);
      }

      .action {
        min-height: 48px;
      }

      .now-playing {
        width: calc(100vw - 20px);
        grid-template-columns: 58px 1fr auto;
        gap: 10px;
        padding: 8px 10px;
        border-radius: 16px;
        bottom: 10px;
      }

      .np-cover {
        width: 48px;
        height: 48px;
        border-radius: 11px;
      }

      .np-title {
        font-size: 16px;
      }

      .np-row {
        margin-top: 5px;
        gap: 8px;
        font-size: 12px;
      }

      .np-time {
        min-width: 35px;
      }

      .np-btn {
        width: 24px;
        height: 24px;
        font-size: 13px;
      }

      .np-btn.play {
        width: 30px;
        height: 30px;
        font-size: 14px;
        border-radius: 9px;
      }
    }

    @keyframes panelIn {
      0% {
        opacity: 0;
        transform: scale(0.98) translateY(16px);
      }
      100% {
        opacity: 1;
        transform: scale(1) translateY(0);
      }
    }

    @keyframes rise {
      0% {
        opacity: 0;
        transform: translateY(18px);
      }
      100% {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes blobFloat {
      0% {
        transform: translate3d(0, 0, 0) rotate(0deg) scale(1);
      }
      45% {
        transform: translate3d(-2.4%, 1.6%, 0) rotate(-2deg) scale(1.04);
      }
      100% {
        transform: translate3d(1.2%, -1.5%, 0) rotate(1.3deg) scale(1.02);
      }
    }

    @keyframes blobDrift {
      0% {
        transform: translate3d(0, 0, 0) scale(1);
      }
      50% {
        transform: translate3d(2%, -2.2%, 0) scale(1.08);
      }
      100% {
        transform: translate3d(-1.4%, 1.2%, 0) scale(1.03);
      }
    }

    @keyframes inkPulse {
      0% {
        transform: translate3d(0, 0, 0) scale(1);
        opacity: 0.88;
      }
      50% {
        transform: translate3d(1.8%, -1.3%, 0) scale(1.07);
        opacity: 0.96;
      }
      100% {
        transform: translate3d(-1.4%, 1.2%, 0) scale(1.02);
        opacity: 0.9;
      }
    }

    @keyframes dotPulse {
      0% {
        transform: scale(1);
        opacity: 0.86;
      }
      50% {
        transform: scale(1.2);
        opacity: 1;
      }
      100% {
        transform: scale(1);
        opacity: 0.86;
      }
    }

    @media (prefers-reduced-motion: reduce) {
      * {
        animation: none !important;
        transition: none !important;
      }
    }
  </style>
</head>
<body class="pre-enter">
  <div id="introGate" class="intro-gate">
    <button id="enterSite" class="enter-button" type="button">✦ENTER✦</button>
    <span class="intro-dot" aria-hidden="true"></span>
  </div>

  <main class="scene">
    <div class="ink-mask ink-mask-right" aria-hidden="true"></div>
    <div class="ink-mask ink-mask-left" aria-hidden="true"></div>

    <section class="content">
      <article class="panel">
        <div class="avatar-wrap">
          <img id="profilePhoto" src="" alt="Profile photo" />
        </div>

        <h1>qwezil</h1>

        <div class="actions">
          <a href="https://discord.com/users/1466764005002707109" class="action" target="_blank" rel="noopener noreferrer">
            <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
              <path d="M8 15c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2Zm8 0c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2Z" fill="currentColor"></path>
              <path d="M6.5 17.5c1.5 1 3.4 1.5 5.5 1.5s4-.5 5.5-1.5M5 9.5c1.4-1.2 4.2-2 7-2s5.6.8 7 2" stroke="currentColor" stroke-width="1.8" stroke-linecap="round"></path>
            </svg>
            discord
          </a>
        </div>
      </article>
    </section>
  </main>

  <section class="now-playing" id="nowPlaying" aria-label="Now playing">
    <img
      id="trackCover"
      class="np-cover"
      src="https://i.scdn.co/image/ab67616d00001e02ec09e95f7c73fa1f6f7b01e2"
      alt="Track cover"
    />
    <div class="np-main">
      <p id="trackTitle" class="np-title">spotify track</p>
      <div class="np-row">
        <span id="trackTimeCurrent" class="np-time">0:00</span>
        <div class="np-bar" aria-hidden="true"><span id="trackProgressFill" class="np-fill"></span></div>
        <span id="trackTimeTotal" class="np-time">0:00</span>
      </div>
    </div>
    <div class="np-controls" aria-label="Player controls">
      <button id="npPrev" class="np-btn" type="button" aria-label="Previous track">◀</button>
      <button id="npPlayPause" class="np-btn play" type="button" aria-label="Play or pause">▶</button>
      <button id="npNext" class="np-btn" type="button" aria-label="Next track">▶</button>
    </div>
  </section>

  <div id="spotifyApiHost" aria-hidden="true"></div>
  <script src="https://open.spotify.com/embed/iframe-api/v1" async></script>
  <script>
    /*
      Вставьте сюда свою ссылку на фото:
      Пример: const PHOTO_URL = "https://site.com/my-photo.jpg";
    */
    const PHOTO_URL = "https://tenor.com/view/obito-uchiha-mangekyou-sharingan-naruto-shippuden-obito-kid-obito-gif-10767805831871813396";

    const img = document.getElementById("profilePhoto");
    img.src = PHOTO_URL;
    img.addEventListener("error", () => {
      img.alt = "Укажите корректный URL изображения в PHOTO_URL";
      img.style.objectFit = "contain";
      img.style.padding = "18px";
      img.style.opacity = "0.65";
    });

    const introGate = document.getElementById("introGate");
    const enterSite = document.getElementById("enterSite");
    const spotifyApiHost = document.getElementById("spotifyApiHost");
    const trackCover = document.getElementById("trackCover");
    const trackTitle = document.getElementById("trackTitle");
    const trackTimeCurrent = document.getElementById("trackTimeCurrent");
    const trackTimeTotal = document.getElementById("trackTimeTotal");
    const trackProgressFill = document.getElementById("trackProgressFill");
    const npPlayPause = document.getElementById("npPlayPause");
    const npPrev = document.getElementById("npPrev");
    const npNext = document.getElementById("npNext");
    const SPOTIFY_TRACK_ID = "3PZzhgmBriWeraWpVfztSN";
    const SPOTIFY_URI = `spotify:track:${SPOTIFY_TRACK_ID}`;
    const SPOTIFY_URL = `https://open.spotify.com/track/${SPOTIFY_TRACK_ID}`;
    let hasEntered = false;
    let spotifyController = null;
    let queuedPlay = false;
    let spotifyPlaying = false;
    let positionMs = 0;
    let durationMs = 0;

    const formatTime = (ms) => {
      const totalSec = Math.max(0, Math.floor(ms / 1000));
      const minutes = Math.floor(totalSec / 60);
      const seconds = totalSec % 60;
      return `${minutes}:${String(seconds).padStart(2, "0")}`;
    };

    const renderTimeline = () => {
      const safeDuration = Math.max(durationMs, 0);
      const safePosition = Math.min(Math.max(positionMs, 0), safeDuration || Number.MAX_SAFE_INTEGER);
      const progress = safeDuration > 0 ? (safePosition / safeDuration) * 100 : 0;

      trackProgressFill.style.width = `${progress}%`;
      trackTimeCurrent.textContent = formatTime(safePosition);
      trackTimeTotal.textContent = formatTime(safeDuration);
    };

    const setPlayVisual = () => {
      npPlayPause.textContent = spotifyPlaying ? "❚❚" : "▶";
    };

    const normalizeTrackTitle = (raw) =>
      raw
        .replace(/\s*\|\s*Spotify\s*$/i, "")
        .replace(/\s*-\s*song by\s.*$/i, "")
        .replace(/\s*-\s*single by\s.*$/i, "")
        .trim();

    const loadTrackMeta = async () => {
      try {
        const response = await fetch(`https://open.spotify.com/oembed?url=${encodeURIComponent(SPOTIFY_URL)}`);
        if (!response.ok) return;
        const meta = await response.json();

        if (typeof meta.title === "string" && meta.title.trim()) {
          trackTitle.textContent = normalizeTrackTitle(meta.title);
        }
        if (typeof meta.thumbnail_url === "string" && meta.thumbnail_url.trim()) {
          trackCover.src = meta.thumbnail_url;
        }
      } catch (_) {}
    };

    const playSpotify = () => {
      if (!spotifyController) {
        queuedPlay = true;
        return;
      }

      try {
        spotifyController.play();
        spotifyPlaying = true;
        setPlayVisual();
      } catch (_) {}
    };

    const pauseSpotify = () => {
      if (!spotifyController) return;
      try {
        spotifyController.pause();
        spotifyPlaying = false;
        setPlayVisual();
      } catch (_) {}
    };

    const seekSpotify = (ratio) => {
      if (!spotifyController || typeof spotifyController.seek !== "function" || durationMs <= 0) return;
      const next = Math.round(durationMs * Math.min(1, Math.max(0, ratio)));
      try {
        spotifyController.seek(next);
        positionMs = next;
        renderTimeline();
      } catch (_) {}
    };

    window.onSpotifyIframeApiReady = (IFrameAPI) => {
      const options = {
        uri: SPOTIFY_URI,
        width: "1",
        height: "1",
        theme: "0",
      };

      IFrameAPI.createController(spotifyApiHost, options, (EmbedController) => {
        spotifyController = EmbedController;

        if (typeof spotifyController.addListener === "function") {
          spotifyController.addListener("playback_update", (event) => {
            const state = event && (event.data || event);
            if (!state) return;

            if (typeof state.isPaused === "boolean") {
              spotifyPlaying = !state.isPaused;
              setPlayVisual();
            }
            if (typeof state.position === "number") {
              positionMs = state.position;
            }
            if (typeof state.duration === "number") {
              durationMs = state.duration;
            }

            renderTimeline();
          });
        }

        if (queuedPlay) {
          queuedPlay = false;
          playSpotify();
        }
      });
    };

    npPlayPause.addEventListener("click", () => {
      if (spotifyPlaying) {
        pauseSpotify();
      } else {
        playSpotify();
      }
    });

    npPrev.addEventListener("click", () => {
      if (spotifyController && typeof spotifyController.previous === "function") {
        try {
          spotifyController.previous();
        } catch (_) {}
      } else {
        seekSpotify(0);
      }
    });

    npNext.addEventListener("click", () => {
      if (spotifyController && typeof spotifyController.next === "function") {
        try {
          spotifyController.next();
        } catch (_) {}
      }
    });

    const timelineTicker = window.setInterval(() => {
      if (!spotifyPlaying || durationMs <= 0) return;
      positionMs = Math.min(positionMs + 250, durationMs);
      renderTimeline();
    }, 250);

    window.addEventListener("beforeunload", () => {
      window.clearInterval(timelineTicker);
    });

    const enterExperience = async () => {
      if (hasEntered) return;
      hasEntered = true;
      document.body.classList.remove("pre-enter");
      document.body.classList.add("site-entered");
      introGate.classList.add("is-hidden");
      playSpotify();
    };

    enterSite.addEventListener("click", enterExperience);

    window.addEventListener("keydown", (event) => {
      if (hasEntered) return;
      if (event.key !== "Enter" && event.key !== " ") return;
      event.preventDefault();
      enterExperience();
    });

    setPlayVisual();
    renderTimeline();
    loadTrackMeta();

  </script>
</body>
</html>
